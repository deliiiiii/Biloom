将制谱器的谱面文件导出的步骤：

​	①解压Biloomer vx.x.xx.zip，电脑用制谱器将谱面写入电脑文件路径：Biloomer vx.x.xx/Biloomer vx.x.xx_Data/StreamingAssets/Sheet/[id] - [title] - [composer].json

​	②安装Biloom vx.x.xx.apk，手机读取谱面文件的路径：[storage/emulated/0/]  Android/data/com.UniqueGame.Biloom/files/Sheet/[id] - [title] - [composer].json

​	③用电脑里的那个json文件覆盖手机里的json

PS：手机第一次安装时会自动生成json文件，但是里面内容是一个note也没有的状态。虽然手机上也可以用制谱器，但是缺很多功能.感觉不如用电脑上设置的快捷键

PPS：想删除所有note，最简单的方法是关闭游戏，删除json文件，重进游戏会自动生成json

**<u>PPPS：做完谱了一定要点Wake Up或者Rehearse出制谱器才会保存</u>**

PPPPS：添加新歌需要重新发个新版本



##### **<u>Weave-进度条</u>**

| 名称        | 解释                                                         |
| ----------- | ------------------------------------------------------------ |
| \| \| or >  | 暂停or播放                                                   |
| beat        | 每多少拍显示一条线，例如，填入1/4后，对于BPM是150的歌，每秒钟有150/60=2.5拍，会有2.5 / (1/4)  = 10根红线流过 |
| line offset | 网格线偏移（单位ms 值越大 网格线离判定线越远），影响的是Z轴吸附，note位置不会变 |
| pitch       | 音乐倍速                                                     |
| note speed  | 音符下落速度，其密度（=个数/时间）不变                       |

***PS 输入框的数字改了按回车才有效，ΔX、ΔZ除外**

##### Weave-<u>MelodyInfo面板</u>

| 名称      | 解释                                               |
| --------- | -------------------------------------------------- |
| Id        | 歌曲唯一认证序号                                   |
| BPM       | 每分钟节拍数                                       |
| Title     | 歌曲标题                                           |
| Composer  | 作曲                                               |
| Intensity | 还没有确定数字所以没显示                           |
| Wake Up   | 退出制谱器返回选歌，需要确认                       |
| Rehearse  | 从当前时间（speed，pitch均适用）进入试玩，不用确认 |

##### <u>Weave-Configuration面板</u>

| 名称         | 解释                                                         |
| ------------ | ------------------------------------------------------------ |
| Type         | 音符种类，Stab单点，Slash滑动（没做），其余待定              |
| Size         | 音符横向大小，默认生成大小为1.6，有1、1.6、2.4、3.2可选。<u>**PS：多选音符时的切换有bug，建议来回多切换几下**</u> |
| Size右边的框 | 黑/白切换，不选中任何note时无法切换，仅选中1个时显示这个note的颜色，选中多个时显示“？”，这时仍能点击并批量修改 |
| X            | 音符左右位置，限制为[-7,7]（左-右）                          |
| Z            | 音符的准确判定时间，范围[0,音乐秒数]（近-远）                |
| ΔX           | 每次左右移动的偏移量，详见←/→键的作用                        |
| ΔZ           | 每次前后移动的偏移量，详见↑/↓键的作用                        |

| 键位                  | 作用                                                         |
| --------------------- | ------------------------------------------------------------ |
| Space(空格)           | 暂停/播放                                                    |
| 鼠标左键              | 选中1个note，先前选中的会取消。疯狂点同一个也不会取消这一个  |
| 按住左Ctrl + 鼠标左键 | 多选note，类似于windows的多选文件。第二次点击取消选中        |
| X                     | 不知道哪个单词，C被复制占了:(   取消所有选中note             |
| S                     | Stab，在当前时间的判定线正中间（X = 0，Z = 当前时间）生成一个单点note，大小1.6 |
| Z                     | 如果当前只选中了1个note，则以X = 0，Z = 那个note的时间生成一个单点note，大小1.6（即复制Z轴note） |
| D                     | Delete，删除所有选中note                                     |
| ~~R~~                 | ~~Reverse，切换黑/白色UI~~                                   |
| ~~R~~                 | ~~Read，读取谱面文件~~                                       |
| ~~W~~                 | ~~Write，写入谱面文件~~                                      |
| ←/→                   | 已选中note向左/右移动ΔX                                      |
| ↑/↓                   | 已选中note向远/近处移动ΔZ，若未输入ΔZ则吸附网格线            |
| ,(书名号<)            | 进度条向左移动 若干 秒                                       |
| .(书名号>)            | 进度条向右移动 若干 秒                                       |
| 右Alt + ,             | 进度条向左移动 (若干*倍数) 秒                                |
| 右Alt + .             | 进度条向右移动 (若干*倍数) 秒                                |

##### <u>Rehearse(试玩)</u>

| 名称                         | 解释                                                         |
| ---------------------------- | ------------------------------------------------------------ |
| 左上角滑动条（暂时一直显示） | 代表whiteRate的值，范围[0,1]（左-右）                        |
| whiteRate                    | 值 [0,1]（黑-白），会影响：UI文字、进度条、背景、note。例如，whiteRate = 0.1，UI文字、进度条很黑但有点白，背景很白但有点黑，黑note为实心，白note透明度为0.2。**直接影响结算界面的黑/白数据哪一个能看清（更突出）** |
| Back To Weave                | 返回到Weave（制谱器）                                        |
| Skip Night                   | 直接跳转到歌曲结束。结束后有3s延迟才显示结算界面             |
| 右上角的\|\|                 | 点击弹出暂停面板：选歌、继续、重开。淡入0.3s，淡出3s         |

##### <u>Settings设置</u>

speed：音符下落速度，和制谱器里note speed等价，**<u>那个输入框的值会这里同步</u>**

offset：玩家将note的Z值额外加上的偏移，单位ms，**<u>PC端不会显示</u>**

​	e.g.1：制谱时offset=0，note的Z=0.3，则游玩时offset设为-300后note的准确判定时刻为0s

​	e.g.2：制谱器中offset=200时note的Z=0.3，则游玩时特地offset设为-300后note的准确判定时刻为-0.2s



##### <u>黑白切换逻辑</u>

白note难度时：不打黑note不影响连击数，打黑note会额外加连击数

黑note难度时：所有白note变为黑note，结算时白note数会很少（其实从头到尾都影响连击数）

记：

black = 黑色已击打的个数

white = 白色已判定的个数

(black  - white)的阈值countThreshold = 10（个），达到这个值会自动变为纯黑，变化时长T = 2（秒），在自动变纯黑之前whiteRate的最小值rateThreshold = 0.8

| 条件                                    |                                                              |
| --------------------------------------- | ------------------------------------------------------------ |
| (black  - white) < 0                    | whiteRate = 1                                                |
| 0 <=  (black  - white) < countThreshold | whiteRate = 1 - (black  - white) / countThreshold * (1 - rateThreshold) |
| (black  - white) >= countThreshold      | whiteRate逐渐变为0（二次函数衰减），持续时长为T              |

e.g.1：黑比白（省略一点描述）多4个，whiteRate = 1 - 4/10 * 0.2 = 0.92

e.g.2：黑比白多5个，whiteRate = 1 - 5/10 * 0.2 = 0.9

e.g.3：黑比白多12个，whiteRate = 1 - 12/10 * 0.2 = 0.76，立即以whiteRate = at^2+bt+0.76进行衰减：经过点（0，0.76）和（2，0），满足开口向上和单调递减



